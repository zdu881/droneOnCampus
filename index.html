<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5G Campus Network Control - Multi-Scenario</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- åœºæ™¯é€‰æ‹©å™¨ -->
      <div class="scenario-selector">
        <div class="data-title">Scenario Selection</div>
        <div class="scenario-buttons">
          <button
            id="drone-scenario-btn"
            class="scenario-btn active"
            data-scenario="drone"
          >
            æ— äººæœºé…é€
          </button>
          <button
            id="vehicle-scenario-btn"
            class="scenario-btn"
            data-scenario="vehicle"
          >
            è‡ªåŠ¨é©¾é©¶è½¦
          </button>
        </div>
      </div>

      <div class="video-container">
        <video id="video" autoplay muted playsinline></video>

        <!-- ç»Ÿä¸€æ§åˆ¶é¢æ¿ -->
        <div class="unified-control-panel">
          <!-- é¢æ¿é€‰æ‹©å™¨ -->
          <div class="panel-selector">
            <label for="panel-select">æ§åˆ¶é¢æ¿:</label>
            <select id="panel-select" class="panel-dropdown">
              <!-- æ— äººæœºåœºæ™¯é€‰é¡¹ -->
              <optgroup label="æ— äººæœºåœºæ™¯" class="drone-options">
                <option value="network-kpi">ç½‘ç»œKPI</option>
                <option value="signal-quality">ä¿¡å·è´¨é‡</option>
                <option value="camera-presets">æ‘„åƒå¤´é¢„è®¾</option>
                <option value="base-station-management">åŸºç«™ç®¡ç†</option>
                <option value="task-management">ä»»åŠ¡ç®¡ç†</option>
              </optgroup>
              <!-- è½¦è¾†åœºæ™¯é€‰é¡¹ -->
              <optgroup label="è‡ªåŠ¨é©¾é©¶è½¦åœºæ™¯" class="vehicle-options">
                <option value="mec-servers">MECæœåŠ¡å™¨</option>
                <option value="vehicle-control">è½¦è¾†æ§åˆ¶</option>
                <option value="network-slice">ç½‘ç»œåˆ‡ç‰‡æ§åˆ¶</option>
                <option value="agent-decision">Agentå†³ç­–</option>
              </optgroup>
            </select>
          </div>

          <!-- é¢æ¿å†…å®¹åŒºåŸŸ -->
          <div class="panel-content">
            <!-- æ— äººæœºåœºæ™¯é¢æ¿ -->

            <!-- ç½‘ç»œKPIé¢æ¿ -->
            <div id="network-kpi-content" class="panel-item drone-panel active">
              <div class="data-title">Network KPI</div>
              <div class="kpi-metric">
                <span class="kpi-label">Bandwidth</span>
                <span class="kpi-value" id="bandwidth-value">-- Mbps</span>
              </div>
              <div class="kpi-metric">
                <span class="kpi-label">RTT Latency</span>
                <span class="kpi-value" id="rtt-value">-- ms</span>
              </div>
              <div class="kpi-metric">
                <span class="kpi-label">Packet Loss</span>
                <span class="kpi-value" id="packet-loss-value">-- %</span>
              </div>
              <div class="kpi-metric">
                <span class="kpi-label">5QI Level</span>
                <span class="kpi-value" id="qos-level-value">--</span>
              </div>
              <div class="realtime-status">
                <div class="status-dot connected" id="network-status-dot"></div>
                <span>Network Active</span>
              </div>
            </div>

            <!-- ä¿¡å·è´¨é‡é¢æ¿ -->
            <div id="signal-quality-content" class="panel-item drone-panel">
              <div class="data-title">Signal Quality</div>
              <div class="kpi-metric">
                <span class="kpi-label">Position</span>
                <span class="kpi-value coordinate-display" id="drone-position"
                  >X: --, Y: --, Z: --</span
                >
              </div>
              <div class="kpi-metric">
                <span class="kpi-label">Signal Strength</span>
                <span class="kpi-value" id="signal-strength-value">--</span>
              </div>
              <div class="kpi-metric">
                <span class="kpi-label">Connection Quality</span>
                <span class="kpi-value" id="connection-quality-value">--</span>
              </div>
              <div class="signal-quality-bar">
                <div class="signal-quality-fill" id="signal-quality-fill"></div>
              </div>
              <div class="realtime-status">
                <div
                  class="status-dot transmitting"
                  id="signal-status-dot"
                ></div>
                <span>Signal Active</span>
              </div>
            </div>

            <!-- æ‘„åƒå¤´é¢„è®¾é¢æ¿ -->
            <div id="camera-presets-content" class="panel-item drone-panel">
              <div class="data-title">Camera Presets</div>
              <div class="camera-controls">
                <button class="camera-btn" data-view="overview">
                  Overview
                </button>
                <button class="camera-btn" data-view="tracking">
                  Tracking
                </button>
                <button class="camera-btn" data-view="close-up">
                  Close-up
                </button>
              </div>
            </div>

            <!-- åŸºç«™ç®¡ç†é¢æ¿ -->
            <div
              id="base-station-management-content"
              class="panel-item drone-panel"
            >
              <div class="data-title">åŸºç«™è®¾å¤‡ç®¡ç†</div>

              <!-- æ·»åŠ åŸºç«™æ§åˆ¶ -->
              <div class="add-station-section">
                <div class="section-title">æ·»åŠ åŸºç«™</div>
                <div class="station-type-selector">
                  <label for="station-type-select">åŸºç«™ç±»å‹:</label>
                  <select id="station-type-select" class="station-dropdown">
                    <option value="charging">ğŸ”‹ å……ç”µåŸºç«™</option>
                    <option value="communication">ğŸ“¡ é€šä¿¡åŸºç«™</option>
                    <option value="weather">ğŸŒ¡ï¸ æ°”è±¡ç«™</option>
                    <option value="security">ğŸ›¡ï¸ å®‰å…¨åŸºç«™</option>
                  </select>
                </div>

                <div class="station-position">
                  <div class="position-inputs">
                    <input
                      type="number"
                      id="station-x"
                      placeholder="Xåæ ‡"
                      class="position-input"
                    />
                    <input
                      type="number"
                      id="station-y"
                      placeholder="Yåæ ‡"
                      class="position-input"
                    />
                    <input
                      type="number"
                      id="station-z"
                      placeholder="Zåæ ‡"
                      class="position-input"
                    />
                  </div>
                  <input
                    type="text"
                    id="station-name"
                    placeholder="åŸºç«™åç§°"
                    class="station-name-input"
                  />
                </div>

                <button id="add-station-btn" class="action-btn primary">
                  æ·»åŠ åŸºç«™
                </button>
              </div>

              <!-- åŸºç«™åˆ—è¡¨ -->
              <div class="stations-list-section">
                <div class="section-title">åŸºç«™åˆ—è¡¨</div>
                <div id="stations-list" class="stations-list">
                  <!-- åŸºç«™é¡¹ç›®å°†ç”±JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
              </div>

              <!-- åŸºç«™ç»Ÿè®¡ -->
              <div class="station-stats">
                <div class="kpi-metric">
                  <span class="kpi-label">æ€»åŸºç«™æ•°</span>
                  <span class="kpi-value" id="total-stations">0</span>
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">åœ¨çº¿åŸºç«™</span>
                  <span class="kpi-value" id="online-stations">0</span>
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">æ•…éšœåŸºç«™</span>
                  <span class="kpi-value" id="failed-stations">0</span>
                </div>
              </div>
            </div>

            <!-- ä»»åŠ¡ç®¡ç†é¢æ¿ -->
            <div id="task-management-content" class="panel-item drone-panel">
              <div class="data-title">ä»»åŠ¡ç®¡ç†</div>
              
              <!-- ä»»åŠ¡æ§åˆ¶åŒºåŸŸ -->
              <div class="task-control-section">
                <div class="section-title">ä»»åŠ¡æ§åˆ¶</div>
                
                <!-- å½“å‰ä»»åŠ¡çŠ¶æ€ -->
                <div class="current-task-status">
                  <div class="kpi-metric">
                    <span class="kpi-label">å½“å‰ä»»åŠ¡</span>
                    <span class="kpi-value" id="current-task">å¾…æœºä¸­</span>
                  </div>
                  <div class="kpi-metric">
                    <span class="kpi-label">ä»»åŠ¡è¿›åº¦</span>
                    <span class="kpi-value" id="task-progress">0%</span>
                  </div>
                  <div class="kpi-metric">
                    <span class="kpi-label">ä»»åŠ¡çŠ¶æ€</span>
                    <span class="kpi-value" id="task-status">ç©ºé—²</span>
                  </div>
                </div>

                <!-- ä»»åŠ¡æ“ä½œæŒ‰é’® -->
                <div class="task-actions">
                  <button id="start-task-btn" class="action-btn primary">å¼€å§‹ä»»åŠ¡</button>
                  <button id="pause-task-btn" class="action-btn secondary" disabled>æš‚åœä»»åŠ¡</button>
                  <button id="stop-task-btn" class="action-btn danger" disabled>åœæ­¢ä»»åŠ¡</button>
                </div>
              </div>

              <!-- ä»»åŠ¡é˜Ÿåˆ— -->
              <div class="task-queue-section">
                <div class="section-title">ä»»åŠ¡é˜Ÿåˆ—</div>
                <div id="task-queue" class="task-queue">
                  <!-- ä»»åŠ¡é¡¹ç›®å°†ç”±JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
                
                <!-- æ·»åŠ ä»»åŠ¡ -->
                <div class="add-task-form">
                  <select id="task-type-select" class="task-dropdown">
                    <option value="delivery">ğŸ“¦ é…é€ä»»åŠ¡</option>
                    <option value="patrol">ğŸ›¡ï¸ å·¡é€»ä»»åŠ¡</option>
                    <option value="inspection">ğŸ” æ£€æŸ¥ä»»åŠ¡</option>
                    <option value="emergency">ğŸš¨ ç´§æ€¥ä»»åŠ¡</option>
                  </select>
                  <input type="text" id="task-description" placeholder="ä»»åŠ¡æè¿°" class="task-input" />
                  <button id="add-task-btn" class="action-btn secondary">æ·»åŠ ä»»åŠ¡</button>
                </div>
              </div>

              <!-- ä»»åŠ¡ç»Ÿè®¡ -->
              <div class="task-stats">
                <div class="kpi-metric">
                  <span class="kpi-label">æ€»ä»»åŠ¡æ•°</span>
                  <span class="kpi-value" id="total-tasks">0</span>
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">å·²å®Œæˆ</span>
                  <span class="kpi-value" id="completed-tasks">0</span>
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">é˜Ÿåˆ—ä¸­</span>
                  <span class="kpi-value" id="queued-tasks">0</span>
                </div>
              </div>
            </div>

            <!-- è½¦è¾†åœºæ™¯é¢æ¿ -->

            <!-- MECæœåŠ¡å™¨é¢æ¿ -->
            <div id="mec-servers-content" class="panel-item vehicle-panel">
              <div class="data-title">MECæœåŠ¡å™¨çŠ¶æ€</div>
              <div class="mec-server" id="mec-east">
                <div class="mec-status">
                  <div class="mec-indicator" id="mec-east-indicator"></div>
                  <span>ä¸œåŒºMEC</span>
                </div>
                <div class="mec-details">
                  <span class="mec-ip">IP: 192.168.1.10</span>
                  <span class="mec-latency" id="mec-east-latency">-- ms</span>
                </div>
              </div>
              <div class="mec-server" id="mec-west">
                <div class="mec-status">
                  <div class="mec-indicator" id="mec-west-indicator"></div>
                  <span>è¥¿åŒºMEC</span>
                </div>
                <div class="mec-details">
                  <span class="mec-ip">IP: 192.168.1.20</span>
                  <span class="mec-latency" id="mec-west-latency">-- ms</span>
                </div>
              </div>
              <div class="mec-server" id="mec-north">
                <div class="mec-status">
                  <div class="mec-indicator" id="mec-north-indicator"></div>
                  <span>åŒ—åŒºMEC</span>
                </div>
                <div class="mec-details">
                  <span class="mec-ip">IP: 192.168.1.30</span>
                  <span class="mec-latency" id="mec-north-latency">-- ms</span>
                </div>
              </div>
              <div class="current-connection">
                <div class="data-title">å½“å‰è¿æ¥</div>
                <div class="connection-info">
                  <span id="current-mec-name">--</span>
                  <span id="current-mec-rtt" class="kpi-value">-- ms</span>
                </div>
              </div>
            </div>

            <!-- è½¦è¾†æ§åˆ¶é¢æ¿ -->
            <div id="vehicle-control-content" class="panel-item vehicle-panel">
              <div class="data-title">è½¦è¾†æ§åˆ¶</div>
              <div class="vehicle-status">
                <div class="kpi-metric">
                  <span class="kpi-label">ä½ç½®</span>
                  <span
                    class="kpi-value coordinate-display"
                    id="vehicle-position"
                    >X: --, Y: --</span
                  >
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">é€Ÿåº¦</span>
                  <span class="kpi-value" id="vehicle-speed">-- km/h</span>
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">æ–¹å‘</span>
                  <span class="kpi-value" id="vehicle-direction">--</span>
                </div>
              </div>
              <div class="vehicle-route-buttons">
                <button class="route-btn" data-route="city-loop">
                  åŸå¸‚ç¯è·¯
                </button>
                <button class="route-btn" data-route="east-west">
                  ä¸œè¥¿è·¯çº¿
                </button>
                <button class="route-btn" data-route="north-south">
                  å—åŒ—è·¯çº¿
                </button>
              </div>
              <div class="auto-handover-control">
                <label>
                  <input type="checkbox" id="auto-handover-enabled" checked />
                  è‡ªåŠ¨MECåˆ‡æ¢
                </label>
              </div>
            </div>

            <!-- ç½‘ç»œåˆ‡ç‰‡æ§åˆ¶é¢æ¿ -->
            <div id="network-slice-content" class="panel-item vehicle-panel">
              <div class="data-title">5G Network Slice Control</div>
              <div class="qos-selector">
                <label for="qos-select">QoS Profile (5QI):</label>
                <select id="qos-select">
                  <option value="1">5QI=1 (Ultra-low latency)</option>
                  <option value="2">
                    5QI=2 (Low latency, high reliability)
                  </option>
                  <option value="5">5QI=5 (IMS Signaling)</option>
                  <option value="7">5QI=7 (Voice/Video calls)</option>
                  <option value="8">5QI=8 (Video streaming)</option>
                  <option value="9" selected>5QI=9 (Best effort)</option>
                </select>
              </div>
              <div class="slice-status">
                <div class="slice-indicator" id="slice-status-indicator"></div>
                <span id="slice-status-text">Slice Status: Inactive</span>
              </div>
              <div class="qos-priority-buttons">
                <button class="qos-btn" id="optimize-latency">
                  Optimize Latency
                </button>
                <button class="qos-btn" id="optimize-bandwidth">
                  Optimize Bandwidth
                </button>
                <button class="qos-btn" id="balanced-mode">
                  Balanced Mode
                </button>
                <button
                  class="qos-btn emergency-override"
                  id="emergency-override"
                >
                  Emergency Override
                </button>
              </div>
            </div>

            <!-- Agentå†³ç­–é¢æ¿ -->
            <div id="agent-decision-content" class="panel-item vehicle-panel">
              <div class="data-title">Agent Decision Engine</div>
              <div class="decision-status">
                <div class="realtime-status">
                  <div class="status-dot" id="agent-status-dot"></div>
                  <span id="agent-status-text">Monitoring</span>
                </div>
              </div>
              <div class="decision-metrics">
                <div class="kpi-metric">
                  <span class="kpi-label">Decision Count</span>
                  <span class="kpi-value" id="decision-count">0</span>
                </div>
                <div class="kpi-metric">
                  <span class="kpi-label">Success Rate</span>
                  <span class="kpi-value" id="success-rate">--</span>
                </div>
              </div>
              <div class="decision-log" id="decision-log">
                <div class="decision-entry">
                  <div class="decision-timestamp">ç³»ç»Ÿåˆå§‹åŒ–</div>
                  <div class="decision-text">Agentå·²å°±ç»ªï¼Œå¼€å§‹ç›‘æ§</div>
                </div>
              </div>
              <div class="agent-controls">
                <button class="qos-btn" id="force-optimization">
                  å¼ºåˆ¶ä¼˜åŒ–
                </button>
                <button class="qos-btn" id="clear-log">æ¸…é™¤æ—¥å¿—</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="controls">
        <h2>5G Campus Drone Network Control</h2>
        <div class="status" id="status">Disconnected</div>

        <div class="control-grid">
          <div class="locations">
            <h3>Delivery Missions</h3>
            <div class="button-row">
              <button
                class="delivery-btn"
                data-from="Warehouse"
                data-to="Library"
              >
                Warehouse â†’ Library
              </button>
              <button
                class="delivery-btn"
                data-from="Warehouse"
                data-to="Dormitory"
              >
                Warehouse â†’ Dormitory
              </button>
              <button
                class="delivery-btn"
                data-from="Library"
                data-to="Cafeteria"
              >
                Library â†’ Cafeteria
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="pixel-streaming.js"></script>
    <script src="api-manager.js"></script>
    <script src="network-manager.js"></script>
    <script src="map-manager.js"></script>
    <script src="agent-manager.js"></script>
    <script src="vehicle-manager.js"></script>
    <script src="unified-panel-manager.js"></script>
    <script src="unified-base-station-manager.js"></script>
    <script src="unified-task-manager.js"></script>
    <script src="app.js"></script>
  </body>
</html>
