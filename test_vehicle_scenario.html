<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½¦è¾†åœºæ™¯æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            border-left: 4px solid #007bff;
            background: #f8f9fa;
        }
        .test-item.passed {
            border-left-color: #28a745;
            background: #f0f9f4;
        }
        .test-item.failed {
            border-left-color: #dc3545;
            background: #f9f0f2;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .status {
            font-weight: bold;
            margin-top: 10px;
        }
        .console-log {
            background: #222;
            color: #0f0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
            margin: 10px 0;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸš— è½¦è¾†åœºæ™¯æµ‹è¯•å¥—ä»¶</h1>
        
        <div class="test-item">
            <h3>æµ‹è¯• 1: HTML ç»“æ„éªŒè¯</h3>
            <button onclick="testHTMLStructure()">éªŒè¯HTMLç»“æ„</button>
            <div id="test1-result" class="status"></div>
        </div>

        <div class="test-item">
            <h3>æµ‹è¯• 2: åœºæ™¯åˆ‡æ¢åŠŸèƒ½</h3>
            <button onclick="testSceneSwitch()">æµ‹è¯•åœºæ™¯åˆ‡æ¢</button>
            <div id="test2-result" class="status"></div>
        </div>

        <div class="test-item">
            <h3>æµ‹è¯• 3: è½¦è¾†åœºæ™¯æ˜¾ç¤º</h3>
            <button onclick="testVehicleDisplay()">æµ‹è¯•è½¦è¾†åœºæ™¯æ˜¾ç¤º</button>
            <div id="test3-result" class="status"></div>
        </div>

        <div class="test-item">
            <h3>æµ‹è¯• 4: é…é€æ§åˆ¶åˆå§‹åŒ–</h3>
            <button onclick="testDeliveryControls()">æµ‹è¯•é…é€æ§åˆ¶</button>
            <div id="test4-result" class="status"></div>
        </div>

        <div class="test-item">
            <h3>å®æ—¶æ§åˆ¶å°</h3>
            <div class="console-log" id="console-log"></div>
        </div>
    </div>

    <script>
        function log(message) {
            const consoleLog = document.getElementById('console-log');
            const timestamp = new Date().toLocaleTimeString();
            consoleLog.innerHTML += `[${timestamp}] ${message}\n`;
            consoleLog.scrollTop = consoleLog.scrollHeight;
        }

        function testHTMLStructure() {
            const result = document.getElementById('test1-result');
            const checks = [];

            // æ£€æŸ¥vehicle-scenario-content
            const vehicleContent = document.querySelector('.vehicle-scenario-content');
            checks.push({ name: 'vehicle-scenario-contentå…ƒç´ å­˜åœ¨', passed: !!vehicleContent });

            // æ£€æŸ¥main-content-panel
            const mainPanel = document.querySelector('.main-content-panel');
            checks.push({ name: 'main-content-panelå…ƒç´ å­˜åœ¨', passed: !!mainPanel });

            // æ£€æŸ¥nesting - vehicle-scenario-contentåº”è¯¥åœ¨main-content-panelå†…
            if (vehicleContent && mainPanel) {
                const isNested = mainPanel.contains(vehicleContent);
                checks.push({ name: 'vehicle-scenario-contentåœ¨main-content-panelå†…', passed: isNested });
            }

            // æ£€æŸ¥properties-panel
            const propsPanel = document.querySelector('.properties-panel');
            checks.push({ name: 'properties-panelå…ƒç´ å­˜åœ¨', passed: !!propsPanel });

            // æ£€æŸ¥è½¦è¾†åœºæ™¯å¡ç‰‡
            const flightCard = document.querySelector('.flight-control-card');
            const stationCard = document.querySelector('.station-maintenance-card');
            const lightCard = document.querySelector('.light-control-card');
            
            checks.push({ name: 'é£è¡Œæ§åˆ¶å¡ç‰‡å­˜åœ¨', passed: !!flightCard });
            checks.push({ name: 'åŸºç«™è¿ç»´å¡ç‰‡å­˜åœ¨', passed: !!stationCard });
            checks.push({ name: 'ç¯å…‰æ§åˆ¶å¡ç‰‡å­˜åœ¨', passed: !!lightCard });

            let html = '<ul>';
            let allPassed = true;
            checks.forEach(check => {
                const status = check.passed ? 'âœ…' : 'âŒ';
                const className = check.passed ? 'passed' : 'failed';
                html += `<li class="${className}">${status} ${check.name}</li>`;
                if (!check.passed) allPassed = false;
            });
            html += '</ul>';

            result.innerHTML = html;
            result.style.color = allPassed ? 'green' : 'red';
            
            log(`HTMLç»“æ„éªŒè¯: ${allPassed ? 'é€šè¿‡' : 'å¤±è´¥'}`);
            if (!allPassed) {
                checks.forEach(c => {
                    if (!c.passed) log(`  âŒ ${c.name}`);
                });
            }
        }

        function testSceneSwitch() {
            const result = document.getElementById('test2-result');
            const vehicleContent = document.querySelector('.vehicle-scenario-content');
            const mainContent = document.querySelector('#viewport-content-page');
            
            if (!vehicleContent || !mainContent) {
                result.innerHTML = 'âŒ æ‰¾ä¸åˆ°å¿…è¦çš„HTMLå…ƒç´ ';
                result.style.color = 'red';
                log('åœºæ™¯åˆ‡æ¢æµ‹è¯•å¤±è´¥: ç¼ºå°‘å¿…è¦çš„HTMLå…ƒç´ ');
                return;
            }

            // æµ‹è¯•åˆ‡æ¢åˆ°vehicleåœºæ™¯
            vehicleContent.style.display = 'block';
            mainContent.style.display = 'none';
            
            const vehicleVisible = vehicleContent.style.display !== 'none' && vehicleContent.offsetParent !== null;
            const mainHidden = mainContent.style.display === 'none';

            let html = '<ul>';
            html += `<li>${vehicleVisible ? 'âœ…' : 'âŒ'} è½¦è¾†åœºæ™¯å†…å®¹å¯è§</li>`;
            html += `<li>${mainHidden ? 'âœ…' : 'âŒ'} æ— äººæœºè§†å£è¢«éšè—</li>`;
            html += '</ul>';

            const allPassed = vehicleVisible && mainHidden;
            result.innerHTML = html;
            result.style.color = allPassed ? 'green' : 'red';
            
            log(`åœºæ™¯åˆ‡æ¢æµ‹è¯•: ${allPassed ? 'é€šè¿‡' : 'å¤±è´¥'}`);
        }

        function testVehicleDisplay() {
            const result = document.getElementById('test3-result');
            const vehicleContent = document.querySelector('.vehicle-scenario-content');
            
            if (!vehicleContent) {
                result.innerHTML = 'âŒ æ‰¾ä¸åˆ°vehicle-scenario-content';
                result.style.color = 'red';
                log('è½¦è¾†åœºæ™¯æ˜¾ç¤ºæµ‹è¯•å¤±è´¥');
                return;
            }

            // æ˜¾ç¤ºvehicle-scenario-content
            vehicleContent.style.display = 'block';
            
            // æ£€æŸ¥å„ä¸ªå¡ç‰‡æ˜¯å¦å¯è§
            const flightCard = vehicleContent.querySelector('.flight-control-card');
            const stationCard = vehicleContent.querySelector('.station-maintenance-card');
            const lightCard = vehicleContent.querySelector('.light-control-card');
            
            const flightVisible = flightCard && flightCard.offsetParent !== null;
            const stationVisible = stationCard && stationCard.offsetParent !== null;
            const lightVisible = lightCard && lightCard.offsetParent !== null;

            let html = '<ul>';
            html += `<li>${flightVisible ? 'âœ…' : 'âŒ'} é£è¡Œæ§åˆ¶å¡ç‰‡å¯è§</li>`;
            html += `<li>${stationVisible ? 'âœ…' : 'âŒ'} åŸºç«™è¿ç»´å¡ç‰‡å¯è§</li>`;
            html += `<li>${lightVisible ? 'âœ…' : 'âŒ'} ç¯å…‰æ§åˆ¶å¡ç‰‡å¯è§</li>`;
            html += '</ul>';

            const allPassed = flightVisible && stationVisible && lightVisible;
            result.innerHTML = html;
            result.style.color = allPassed ? 'green' : 'red';
            
            log(`è½¦è¾†åœºæ™¯æ˜¾ç¤ºæµ‹è¯•: ${allPassed ? 'é€šè¿‡' : 'å¤±è´¥'}`);
        }

        function testDeliveryControls() {
            const result = document.getElementById('test4-result');
            
            // æ£€æŸ¥é…é€æŒ‰é’®
            const deliveryButtons = document.querySelectorAll('[id*="delivery"]');
            const sceneButtons = document.querySelectorAll('[id*="scene"]');
            const deliveryBtns = document.querySelectorAll('.delivery-btn');

            let html = '<ul>';
            html += `<li>${deliveryButtons.length > 0 ? 'âœ…' : 'âŒ'} æ‰¾åˆ°${deliveryButtons.length}ä¸ªé…é€æŒ‰é’®</li>`;
            html += `<li>${sceneButtons.length > 0 ? 'âœ…' : 'âŒ'} æ‰¾åˆ°${sceneButtons.length}ä¸ªåœºæ™¯æŒ‰é’®</li>`;
            html += `<li>${deliveryBtns.length > 0 ? 'âœ…' : 'âŒ'} æ‰¾åˆ°${deliveryBtns.length}ä¸ªdelivery-btnå…ƒç´ </li>`;

            // æ£€æŸ¥DroneSimpleFlightUIç±»
            if (typeof window.DroneSimpleFlightUI !== 'undefined') {
                html += '<li>âœ… DroneSimpleFlightUIç±»å·²åŠ è½½</li>';
            } else {
                html += '<li>âŒ DroneSimpleFlightUIç±»æœªå®šä¹‰</li>';
            }

            html += '</ul>';
            result.innerHTML = html;
            result.style.color = (deliveryButtons.length > 0 && sceneButtons.length > 0) ? 'green' : 'orange';
            
            log(`é…é€æ§åˆ¶æµ‹è¯•å®Œæˆ: æ‰¾åˆ°${deliveryButtons.length}ä¸ªé…é€æŒ‰é’®`);
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•
        window.addEventListener('load', function() {
            log('é¡µé¢å·²åŠ è½½ï¼Œå¼€å§‹è‡ªåŠ¨æµ‹è¯•...');
            setTimeout(() => {
                testHTMLStructure();
                testSceneSwitch();
                testVehicleDisplay();
                testDeliveryControls();
                log('æ‰€æœ‰è‡ªåŠ¨æµ‹è¯•å®Œæˆ');
            }, 500);
        });
    </script>
</body>
</html>
